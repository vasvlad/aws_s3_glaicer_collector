<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>

<link rel="stylesheet" type="text/css" media="screen" href="./css/flick/jquery-ui-1.7.2.custom.css" />
<link rel="stylesheet" type="text/css" media="screen" href="./css/ui.jqgrid.css" />

<style>
html, body {
margin: 0;
padding: 0;
font-size: 80%;
}
</style>
<script type="text/javascript" src="./js/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="./js/i18n/grid.locale-en.js"></script>
<script type="text/javascript" src="./js/jquery.jqGrid.min.js"></script>
<script type="text/javascript">
id_node=0;
level=0;
jQuery().ready(function() {
	jQuery('#table_adjacency').jqGrid({
		url: 'bs3.php?f=1',
		datatype: "json",
		multiselect: false,
		rowNum:50,
		rowList:[50,100,150,200,250,300],
		colNames:["id","Folder","Size",""],
		colModel:[
			{name:'id',index:'id', width:1, hidden:true, key:true},
			{name:'title',index:'title', width:400},
			{name:'size',index:'size', width:100,align:"right"},
			{name:'level',index:'level', width:-1,hidden:true}
		],
		onSelectRow: function(rowid) {
			var data= $("#table_adjacency").jqGrid('getRowData',rowid);
			id = data.id;
			title = data.title;
			id_node= data.id;
			level=data.level;
			if(id == null) {
				id=0; 
				if (jQuery("#table_files").jqGrid('getGridParam','records') >0 ) { 
						jQuery("#table_files").jqGrid('setGridParam',{url:"bs3.php?f=0&id="+id,page:1,search:false}); 
						jQuery("#table_files").jqGrid('setCaption',"file: "+title) .trigger('reloadGrid'); 
				}
				 
			} else { 
				jQuery("#table_files").jqGrid('setGridParam',{url:"bs3.php?f=0&id="+id,page:1,search:false}); 
				jQuery("#table_files").jqGrid('setCaption',"File list in folder: "+title) .trigger('reloadGrid'); 
			}
			jQuery("#table_adjacency").jqGrid('setGridParam',{url:"bs3.php?f=1&id="+id});
			jQuery("#table_adjacency").jqGrid('setCaption',"folder: ") .trigger('reloadGrid'); 
		},
		treeIcons: {plus:'ui-icon-folder-collapsed',minus:'ui-icon-folder-open',leaf:'ui-icon-document'},
		height:'auto',
		caption:'Folders',
		pager : "#ptreegrid",
		hidegrid: false
	});
	jQuery("#table_adjacency").jqGrid('navGrid','#ptreegrid',{edit:false, add:false, del:false,view:true, search: false},//options
	{},
	{}, // add options
	{}, // del options
	{} // search options
	);
	jQuery("#table_adjacency").jqGrid('navGrid','#ptreegrid').navButtonAdd('#ptreegrid',{caption: "Search",caption :"",title : "Search folder",buttonicon: "ui-icon-search", 
		onClickButton: function() {
			jQuery("#table_adjacency").jqGrid('searchGrid', {closeOnEscape: true, multipleSearch: true, closeAfterSearch: true,sopt: ['cn','bw','ew','eq','ne','lt','le','gt','ge']} ); 
		}, 
		position: "last"
	} );
            
	
	jQuery("#table_files").jqGrid({
		height: 100, 
		url:'bs3.php?f=0&id=0', 
		datatype: "json", 
		colNames:['id','File', 'Size'],
		colModel:[ 
			{name:'id',index:'id', width:1, hidden:true, key:true},
			{name:'title',index:'title', width:400},
			{name:'size',index:'size', width:100,align:"right"}], 
		rowNum:5, 
		rowList:[5,10,15,20,25,30],
		height:'auto',
		sortname: 'id', 
		viewrecords: true, 
		sortorder: "asc", 
		multiselect: true, 
		caption:"File list",
		multipleSearch: true,
//onSelectRow: function(rowid) {
//jQuery("#table_files").jqGrid('setGridParam',{url:"bs3.php?f=0&id="+id});
//jQuery("#table_files").jqGrid('setCaption',"File list in folder: "+title) .trigger('reloadGrid');
//},
		pager : "#ptreefiles"});
		
		jQuery("#table_files").jqGrid('navGrid','#ptreefiles',{edit:false, add:false, del:false,view:true, search: false},//options
		{},
		{}, // add options
		{}, // del options
		{} // search options
		);
	jQuery("#table_files").jqGrid('navGrid','#ptreefiles').navButtonAdd('#ptreefiles',{caption: "Search",caption :"",title : "Search file",buttonicon: "ui-icon-search", 
		onClickButton: function() {
			jQuery("#table_files").jqGrid('searchGrid', {closeOnEscape: true, multipleSearch: true, closeAfterSearch: true,sopt: ['cn','bw','ew','eq','ne','lt','le','gt','ge']} ); 
		}, 
		position: "last"
	} );
                 
});
</script>

</head>
<body>
    <table border='0'>
        <tr>
            <td valign="top">
            <table id="table_adjacency"></table>
            <div id="ptreegrid"></div>
            </td>
            <td valign="top">&nbsp;&nbsp;&nbsp;</td>
            <td valign="top">
            <table id="table_files"></table>
            <div id="ptreefiles"></div>
            </td>

        </tr>
    </table>
</body>

</html>
